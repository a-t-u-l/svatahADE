<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description"
        content="Svatah is a behaviour driven automation platform. The Svatah API Client enables deveolpers to test their API on a remote server. Get in touch with us to whitelist the IP if you face any firewall issue." />
    <meta name="author" content="svatah" />
    <title>Svatah ADE</title>

    <!-- Bootstrap core CSS     -->
    <link href="./../css/bootstrap.min.css?v=1.0.5" rel="stylesheet" />
    <!--  Material Dashboard CSS    -->
    <link href="./../css/black-dashboard.css?v=1.1.45455" rel="stylesheet" />
    <!--     Fonts and icons     -->
    <link href="./../css/font-awesome.min.css" rel="stylesheet" type='text/css' />
    <link href='./../css/material-icons-fonts.css' rel='stylesheet' type='text/css' />
    <link href="./../css/poppins-fonts.css" rel="stylesheet" />
    <link href="./../css/jsoneditor.min.css" rel="stylesheet" type="text/css">
    <link href="./../css/svatah.css" rel="stylesheet" />

    <style type="text/css">
        .buttonload {
            background-color: #4CAF50;
            /* Green background */
            border: none;
            /* Remove borders */
            color: white;
            /* White text */
            padding: 12px 24px;
            /* Some padding */
            font-size: 16px;
            /* Set a font-size */
        }

        /* Add a right margin to each icon */
        .fa {
            margin-left: -12px;
            margin-right: 8px;
        }

        .jsoneditor,
        #jsoneditor,
        #requestBody,
        #responseBody {
            z-index: 0;
            height: 400px;
        }

        .nav-tabs .nav-link.active {
            color: #050505;
            background-color: #cec5bb;
            border-color: #dee2e6 #dee2e6 #fff;
        }
    </style>
</head>

<body id="bod" class="white-content">
    <div class="wrapper" style="border-top: 2px solid #e6b31c;">
        <div id="sidebar" class="sidebar" data-color="orange" data-image="#" style="z-index: 3; ">
            <div class="logo">
                <a href="./home.html" target="_blank" class="simple-text logo-mini">
                    S
                </a>
                <a href="./home.html" target="_blank" class="simple-text logo-normal">
                    Svatah
                </a>
            </div>
            <div class="sidebar-wrapper">
                <ul class="nav">

                    <li class="project">
                        <a href="./project.html" data-toggle="tooltip" data-placement="right" title="project">
                            <i class="material-icons">assessment</i>
                            <p>View Projects</p>
                        </a>
                    </li>

                    <li class="newuiproject">
                        <a href="./newproject.html" data-toggle="tooltip" data-placement="right" title="newproject">
                            <i class="material-icons">note_add</i>
                            <p>New Project</p>
                        </a>
                    </li>

                    <!-- <li class="newapiproject">
                        <a href="./apiproject.html" data-toggle="tooltip" data-placement="right" title="newproject">
                            <i class="material-icons">description</i>
                            <p>New API Project</p>
                        </a>
                    </li> -->

                    <li class="api-client active">
                        <a href="./apiclient.html" data-toggle="tooltip" data-placement="right" title="API client">
                            <i class="material-icons">extension</i>
                            <p>API Client</p>
                        </a>
                    </li>

                    <li class="results">
                        <a href="./results.html" data-toggle="tooltip" data-placement="right" title="results">
                            <i class="material-icons">receipt</i>
                            <p>Results</p>
                        </a>
                    </li>

                    <li class="docs">
                        <a href="https://www.svatah.in/docs" target="_blank" data-toggle="tooltip"
                            data-placement="right" title="View docs" id="docsLink">
                            <i class="material-icons">description</i>
                            <p>Docs</p>
                        </a>
                    </li>

                    <li id="darkmode" class="theme">
                        <a class="toggle-label toggle-label-off" data-toggle="tooltip" data-placement="right"
                            title=" toggle dark mode">
                            <i id="darkmodeicon" class="material-icons">toggle_on</i>
                            <p>darkmode</p>
                        </a>
                    </li>

                </ul>
            </div>
        </div>
        <div id="historyContainer" class="sidebar"
            style="border-top: 2px solid #e6b31c; background: #171a1c; margin-left: 68px; width:230px; z-index: 2;border-right:1px dotted #3a3938;">
            <div class="logo">
                <div class="simple-text logo-normal">
                    History
                </div>
            </div>
            <button type="button" class="btn btn-sm btn-danger btn-link pull-right" data-toggle="modal"
                data-target="#clearHistoryAlert">
                clear history
            </button>
            <div id="historyWrapper" class="sidebar-wrapper">
                <ul id="history" class="nav wraptext">
                </ul>
            </div>
        </div>
        <div class="main-panel">
            <div class="content">
                <div class="container-fluid">
                    <div class="row">
                        <div id="alertbar" class="col-md-12">

                        </div>
                    </div>

                    <!-- Modal -->
                    <div class="modal fade" id="clearHistoryAlert" tabindex="-1" role="dialog"
                        aria-labelledby="clearHistoryAlertTitle" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="card modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="clearHistoryAlertLongTitle">Alert</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body" style="color:#7d7f84;">
                                    You are about to clear your API request history. Are you sure?
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-info btn-simple"
                                        data-dismiss="modal">Close</button>
                                    <button type="button" onclick="clearHistory()" class="btn btn-warning btn-simple"
                                        data-dismiss="modal">Delete</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">

                        <div class="col-sm-10" style="margin-left: 210px;">
                            <form class="form-horizontal">
                                <fieldset>
                                    <div class="card">
                                        <div class="card-header">
                                            <h4 class="card-title">Request</h4>
                                        </div>
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-sm-2">
                                                    <div class="form-group label-floating">
                                                        <label class="control-label">Http Method</label>
                                                        <select id="httpMethod" name="httpMethod" type="text"
                                                            class="form-control" onchange="getSelected(this);"
                                                            value="GET">
                                                            <option value="GET" id="getOption" selected="selected">GET
                                                            </option>
                                                            <option value="POST">POST</option>
                                                            <option value="PUT">PUT</option>
                                                            <option value="PATCH">PATCH</option>
                                                            <option value="DELETE">DELETE</option>
                                                        </select>
                                                    </div>
                                                </div>

                                                <div class="col-sm-10">
                                                    <div class="form-group label-floating">
                                                        <label class="control-label">Url</label>
                                                        <input type="text" class="form-control" required="required"
                                                            value="" id="uri" name="uri" required />
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-sm-3">
                                                    <div class="form-group label-floating">
                                                        <label class="control-label">Content Type</label>
                                                        <select id="contentType" name="contentType" type="text"
                                                            class="form-control" value="">
                                                            <option value="json">Application&#47;Json</option>
                                                        </select>
                                                    </div>
                                                </div>

                                                <div class="col-sm-3">
                                                    <div class="form-group label-floating">
                                                        <label class="control-label">Accept All SSL
                                                            Certificates</label>
                                                        <select id="acceptAllSslCert" name="acceptAllSslCert"
                                                            type="text" class="form-control" value="false">
                                                            <option value="false" selected="selected">False</option>
                                                            <option value="true">True</option>
                                                        </select>
                                                    </div>
                                                </div>

                                                <div class="col-sm-3">
                                                    <div class="form-group label-floating">
                                                        <label class="control-label">Follow Redirects</label>
                                                        <select id="followRedirect" name="followRedirect" type="text"
                                                            class="form-control" value="true">
                                                            <option value="true" selected="selected">True</option>
                                                            <option value="false">False</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                
                                                <div class="col-sm-3">
                                                    <div class="form-group label-floating">
                                                        <label class="control-label">Timeout in seconds</label>
                                                        <input type="number" class="form-control" required="required"
                                                            value="30" id="timeout" name="timeout" required />
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Editable table -->
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <input id="apiEditor" name="headers" type="text"
                                                            class="form-control" value="" hidden="hidden" />
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div id="dataAlert" class="alert-danger" hidden="hidden">
                                                        <span>Header field/s can not have empty key or value!</span>
                                                    </div>

                                                    <div id="api-header-table" class="table-editable">
                                                        <table class="table table-bordered table-responsive-md">
                                                            <tr>
                                                                <th style="font-weight: normal;">Header Key</th>
                                                                <th style="font-weight: normal;">Header Value</th>
                                                                <th></th>
                                                            </tr>
                                                            <!-- This is our clonable table line -->
                                                            <tr class="hide" hidden="hidden">
                                                                <td contenteditable="true"></td>
                                                                <td contenteditable="true"></td>
                                                                <td>
                                                                    <span class="table-remove">
                                                                        <button id="remove-api-header-row" type="button"
                                                                            rel="tooltip" title="Delete"
                                                                            class="btn btn-danger btn-link btn-sm">
                                                                            <i class="material-icons">delete</i>
                                                                        </button>
                                                                    </span>
                                                                </td>
                                                            </tr>
                                                            <!-- ------------------------------- -->


                                                        </table>
                                                        <small id="variableHelp" class="form-text text-muted">Please
                                                            define/change all the headers key and value accordingly in
                                                            the
                                                            header table.
                                                        </small>
                                                        <span class="table-add mb-3 mr-2">
                                                            <button id="add-api-header-row" type="button" rel="tooltip"
                                                                title="Add" class="btn btn-yellow btn-link btn-sm"><i
                                                                    class="material-icons">add</i>
                                                            </button>
                                                        </span>
                                                        <span class="export-btn mb-3 mr-2">
                                                            <button id="api-header-export-btn" type="button"
                                                                disabled="true" rel="tooltip" title="Export"
                                                                class="btn btn-yellow btn-link btn-sm save-btn"><i
                                                                    class="material-icons">save</i>
                                                            </button>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>

                                            <div id="notGetDivCheck" style="display:none;" class="row">
                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <label>Request Body</label>
                                                        <div class="form-group label-floating">
                                                            <div style="min-width :100%" rows="11" value=""
                                                                id="requestBody" name="requestBody">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </fieldset>
                            </form>

                            <button id="testApi" name="testApi" type="submit" onclick="callApi()"
                                class="btn btn-success ge add-new-flow-btn"><i id="buttonLoader"></i>Send
                            </button>
                            <hr />

                            <nav>
                                <div class="nav nav-tabs" id="nav-tab" role="tablist" style="border-bottom: none;">
                                    <a class="nav-item nav-link active" id="napi-response-tab" data-toggle="tab"
                                        href="#napi-response" role="tab" aria-controls="napi-response"
                                        aria-selected="true">Response</a>
                                    <a class="nav-item nav-link" id="response-header-tab" data-toggle="tab"
                                        href="#response-header" role="tab" aria-controls="response-header"
                                        aria-selected="false">Headers</a>
                                </div>
                            </nav>
                            <div class="tab-content" id="nav-tabContent">
                                <div class="card tab-pane fade show active" id="napi-response" role="tabpanel"
                                    aria-labelledby="napi-response-tab">
                                    
                                        <h4 id="responseCode" class="card-title">Response will come here</h4>
                                        <div id="responseBody">
                                        </div>
                                    
                                </div>
                                <div class="card tab-pane fade" id="response-header" role="tabpanel"
                                    aria-labelledby="response-header-tab">

                                </div>
                            </div>
                        </div>

                    </div>
                    <footer class="footer">
                        <p class="copyright pull-right">
                            &copy;
                            <script>
                                document.write(new Date().getFullYear())


                            </script>
                            <a href="./home.html" target="_blank">Svatah</a>, Behaviour Driven Automation Platform
                        </p>
                    </footer>
                </div>
            </div>
        </div>
    </div>
</body>
<script>if (typeof module === 'object') { window.module = module; module = undefined; }</script>
<!--   Core JS Files   -->
<script src="./../js/jquery.min.js?v=3.4.0.1" type="text/javascript"></script>
<script src="./../js/popper.min.js?v=1.0.2" type="text/javascript"></script>
<script src="./../js/bootstrap.min.js?v=1.0.2" type="text/javascript"></script>
<!--  PerfectScrollbar Library -->
<script src="../js/perfect-scrollbar.jquery.min.js?v=1.0.1"></script>
<!-- Material Dashboard javascript methods -->
<script src="./../js/black-dashboard.js?v=1.0.14"></script>
<script src="./../js/jsoneditor.min.js"></script>
<script src="./../js/svatah.js"></script>
<script src="./../js/apiclient.js"></script>
<script>if (window.module) module = window.module;</script>

<script>
    let tableCounter = 1;
    var tableArr = ['#api-header-table'];
    var exportButtonArr = ['#api-header-export-btn'];
    let tableAddRowButtonArr = ['#add-api-header-row'];
    let tableRemoveRowButtonArr = ['#remove-api-header-row'];
    let createProjectButton = '#testApi';
    let editorArr = ['#apiEditor'];

    for (let index = 0; index < tableCounter; index++) {
        $(tableAddRowButtonArr[index]).click(function () {
            var $clone = $(tableArr[index]).find('tr.hide').clone(true).removeClass('hide table-line');
            $(tableArr[index]).find('table').append($clone.prop("hidden", false));
            $(exportButtonArr[index]).prop("disabled", false);
            $(createProjectButton).prop("disabled", true);
        });

        $(tableRemoveRowButtonArr[index]).click(function () {
            $(this).parents('tr').detach();
            $(exportButtonArr[index]).prop("disabled", false);
            $(createProjectButton).prop("disabled", true);
        });

        $(tableArr[index]).on("click", 'tr td', function () {
            $(exportButtonArr[index]).prop("disabled", false);
            $(createProjectButton).prop("disabled", true);
        });

        // A few jQuery helpers for exporting only
        jQuery.fn.pop = [].pop;
        jQuery.fn.shift = [].shift;

        $(exportButtonArr[index]).click(function () {
            console.log('tableArr[index] : ' + tableArr[index])
            var $rows = $(tableArr[index]).find("tr:not(:hidden)");
            var headers = [];
            var data = [];

            // Get the headers (add special header logic here)
            $($rows.shift()).find('th:not(:empty)').each(function () {
                headers.push($(this).text().toLowerCase());
            });

            // Turn all existing rows into a loopable array
            $rows.each(function () {
                var $td = $(this).find('td');
                var h = {};

                // Use the headers from earlier to name our hash keys
                headers.forEach(function (header, i) {
                    h[header] = $td.eq(i).text();
                });
                console.log('val : ' + JSON.stringify(h))
                data.push(h);
            });

            // Output the result
            var flag = true;
            for (let member in data) {
                for (let field in data[member]) {
                    if (data[member][field] == '') {
                        flag = false;
                        break;
                    }
                    if (!flag) {
                        break;
                    }
                }
                if (!flag) {
                    break;
                }
            }
            if (flag) {
                //console.log(JSON.stringify(data));
                $(editorArr[index]).val(JSON.stringify(data));
                $(exportButtonArr[index]).prop("disabled", true);
                $(createProjectButton).prop("disabled", false);
            }
            else {
                showAlert('alertbar', 'danger', 'can not save empty row')
                $(createProjectButton).prop("disabled", true)
            }
            flag = true;
        });

        $(createProjectButton).on('click', function () {
            if ($(exportButtonArr[0]).attr('disabled') == 'disabled') {
                $(createProjectButton).prop('disabled', false);
            }
            else {
                showAlert('alertbar', 'danger', 'Please save headers first ...')
                $(createProjectButton).prop('disabled', true);
            }
        });
    }
</script>

<script>
    function getSelected(nameSelect) {
        if (nameSelect) {
            let getOptionValue = document.getElementById("getOption").value;
            if (getOptionValue == nameSelect.value) {
                document.getElementById("notGetDivCheck").style.display = "none";
            }
            else {
                document.getElementById("notGetDivCheck").style.display = "block";
            }
        }
        else {
            document.getElementById("notGetDivCheck").style.display = "block";
        }
    }
</script>

<script>
    let container = document.getElementById('requestBody');
    let options = {
        mode: 'code',
        modes: ['code', 'text'], // allowed modes
        onError: function (err) {
            alert(err.toString());
        },
        onModeChange: function (newMode, oldMode) {
            console.log('Mode switched from', oldMode, 'to', newMode);
        }
    };
    var json = '';
    var posteditor = new JSONEditor(container, options, json);
</script>

<script>
    const ps = new PerfectScrollbar('#historyWrapper');
</script>

</html>
